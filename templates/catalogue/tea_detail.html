{% extends 'catalogue/home.html' %}
{% load static %}
{% load integer_division %}

{% block content %}
    <div class="mx-2">
        <span class="fs-4">{{ tea.name }}</span>
        <div class="row row-cols-2">
            <div class="col col-auto">
                <img class="product-image d-block my-3" src="{{ tea.image.url }}" alt="изображение товара">
            </div>
            <div class="col col-auto">
                <div class="mt-2">
                    <span class="fs-5">Количество</span>
                    <form>
                        {% csrf_token %}
                        <div class="d-flex my-2">
                            <span class="flex-shrink-0">{{ amount_step }} г.</span>
                            <input type="hidden" name="teaId" value="{{ tea.id }}">
                            <input type="hidden" name="nextPage" value="{{ request.path }}">
                            <input type="range"
                            name="amount"
                            class="form-range mx-2" 
                            min="{{ amount_step }}" value="{{ amount_step }}" 
                            max="{{ tea.tea_amount|int_divide:amount_step }}" step="{{ amount_step }}"
                            oninput="updateTotal(this, {{ tea.price }})">
                            <span class="flex-shrink-0">{{ tea.tea_amount|int_divide:amount_step }} г.</span>
                        </div>
                        <span id="total" class="fs-5">{{ amount_step }} г. за {{ tea.price }} ₽</span>
                        <br class="mb-3">
                        <button type="submit" class="btn btn-primary mb-3">В корзину</button>
                    </form>
                </div>
            </div>
        </div>
        <span class="fs-5">Описание</span>
        <p class="mt-2">{{ tea.description }}</p>
        <span class="fs-5">Комментарии</span>
    </div>
    <script>
        function updateTotal(input, price) {
            totalDisplay = document.getElementById('total');
            totalDisplay.textContent = `${input.value} г. за ${input.value*price/input.step} ₽`;
        }
    </script>
{% endblock content %}